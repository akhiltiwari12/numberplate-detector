<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog : Homepage</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,400;0,500;0,600;1,600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/home.css">
</head>
<body>
    <nav class="navbar">
        <img src="img/logo.png" class="logo" alt="">
        <ul class="links-container">
            <li class="link-item"><a href="/" class="link">home</a></li>
            <li class="link-item"><a href="/editor" class="link">editor</a></li>
        </ul>
    </nav>

    <header class="header">
        <div class="content">
            <h1 class="heading">
                <span class="small">welcome in the world of</span>
                blog
                <span class="no-fill">writing</span>
            </h1>
            <a href="/editor" class="btn">write a blog</a>
        </div>
    </header>

    <!-- blog section -->
    <section class="blogs-section" id="blogsSection">
        <!-- Blogs will be dynamically loaded here -->
    </section>

    <script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-auth.js"></script>
    <script src="js/firebase.js"></script>
    <script src="js/home.js"></script>

    <script>
        // Check if user is logged in
        firebase.auth().onAuthStateChanged((user) => {
            if (user) {
                // User is signed in, load homepage content
                loadHomePage();
            } else {
                // No user is signed in, redirect to login page
                window.location.href = 'login.html';
            }
        });

        const blogsSection = document.getElementById('blogsSection');

        // Function to load blog content
        const loadHomePage = () => {
            db.collection("blogs").get().then((querySnapshot) => {
                querySnapshot.forEach((blog) => {
                    createBlog(blog);
                });
            });
        }

        const createBlog = (blog) => {
            const data = blog.data();
            blogsSection.innerHTML += `
                <div class="blog-card">
                    <img src="${data.bannerImage}" class="blog-image" alt="">
                    <h1 class="blog-title">${data.title.substring(0, 100)}...</h1>
                    <p class="blog-overview">${data.article.substring(0, 200)}...</p>
                    <a href="/${blog.id}" class="btn dark">Read</a>
                </div>
            `;
        }
    </script>
</body>
</html>
